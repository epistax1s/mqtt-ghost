"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[419],{8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const c={},t=s.createContext(c);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),s.createElement(t.Provider,{value:n},e.children)}},9182:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"components/action","title":"Action","description":"The action component is a named code block in the DSL designed to execute arbitrary logic. Unlike publish, which focuses","source":"@site/docs/components/action.md","sourceDirName":"components","slug":"/components/action","permalink":"/mqtt-mimic/docs/components/action","draft":false,"unlisted":false,"editUrl":"https://github.com/epistax1s/mqtt-mimic/tree/master/doc/docs/components/action.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Subscribe","permalink":"/mqtt-mimic/docs/components/subscribe"},"next":{"title":"Recipes","permalink":"/mqtt-mimic/docs/category/recipes"}}');var c=i(4848),t=i(8453);const o={sidebar_position:4},l="Action",r={},d=[{value:"Basic Syntax",id:"basic-syntax",level:2},{value:"Properties",id:"properties",level:2},{value:"1. <code>justDo</code>",id:"1-justdo",level:3},{value:"2. <code>schedule</code> (Scheduling Block)",id:"2-schedule-scheduling-block",level:3},{value:"Key Features",id:"key-features",level:2},{value:"Controlling Execution",id:"controlling-execution",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"1. Simple Action",id:"1-simple-action",level:3},{value:"2. Scheduled Action",id:"2-scheduled-action",level:3},{value:"3. Dynamic Action with Control",id:"3-dynamic-action-with-control",level:3},{value:"4. Interaction with Publish",id:"4-interaction-with-publish",level:3},{value:"Notes",id:"notes",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"action",children:"Action"})}),"\n",(0,c.jsxs)(n.p,{children:["The ",(0,c.jsx)(n.code,{children:"action"})," component is a named code block in the DSL designed to execute arbitrary logic. Unlike ",(0,c.jsx)(n.code,{children:"publish"}),", which focuses\non sending MQTT messages, ",(0,c.jsx)(n.code,{children:"action"})," is for running general-purpose code. It can be triggered manually, scheduled to run\nperiodically, or controlled via activation and deactivation."]}),"\n",(0,c.jsx)(n.h2,{id:"basic-syntax",children:"Basic Syntax"}),"\n",(0,c.jsxs)(n.p,{children:["An ",(0,c.jsx)(n.code,{children:"action"})," block is defined with a name and a closure containing the logic to execute. Here\u2019s a minimal example:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-groovy",children:'action("sayHello") {\n    justDo = {\n        println "Hello from action!"\n    }\n}\n'})}),"\n",(0,c.jsxs)(n.p,{children:["This creates an action named ",(0,c.jsx)(n.code,{children:'"sayHello"'})," that prints a message when invoked."]}),"\n",(0,c.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,c.jsxs)(n.h3,{id:"1-justdo",children:["1. ",(0,c.jsx)(n.code,{children:"justDo"})]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Description"}),": The closure containing the main logic to execute when the action runs."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Type"}),": Closure."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Required"}),": Yes."]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-groovy",children:'justDo = { \n    println "Doing some work" \n}\n'})}),"\n",(0,c.jsxs)(n.h3,{id:"2-schedule-scheduling-block",children:["2. ",(0,c.jsx)(n.code,{children:"schedule"})," (Scheduling Block)"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Description"}),": A block to configure periodic execution of the action."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Required"}),": No."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Subparameters"}),":","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"interval"}),": The interval (in milliseconds) between executions.","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Type"}),": Long."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Required"}),": Yes (within the block)."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Example"}),": ",(0,c.jsx)(n.code,{children:"interval = 5_000"})]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"startImmediately"}),": Whether the schedule starts immediately on client startup.","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Type"}),": Boolean."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Required"}),": No."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Default"}),": false."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Example"}),": ",(0,c.jsx)(n.code,{children:"startImmediately = true"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-groovy",children:"schedule {\n    interval = 5_000\n    startImmediately = true\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Arbitrary Logic"}),": ",(0,c.jsx)(n.code,{children:"justDo"})," allows execution of any code, not tied to MQTT publishing."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Scheduling"}),": Use ",(0,c.jsx)(n.code,{children:"schedule"})," to run the action at regular intervals."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Control"}),": Supports manual invocation with ",(0,c.jsx)(n.code,{children:"doAction"}),", and schedule control with ",(0,c.jsx)(n.code,{children:"activateAction"})," and ",(0,c.jsx)(n.code,{children:"deactivateAction"}),"."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Dynamic"}),": The configuration is rebuilt each time the action runs, enabling use of dynamic data."]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"controlling-execution",children:"Controlling Execution"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:'doAction("name")'}),": Immediately runs the action once."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:'activateAction("name")'}),": Activates the action\u2019s schedule, if defined, starting periodic execution."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:'deactivateAction("name")'}),": Deactivates the schedule, stopping automatic execution until reactivated or manually triggered."]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"These functions can be called from anywhere in the DSL \u2013 within subscribe, publish, or standalone code."}),"\n",(0,c.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,c.jsx)(n.h3,{id:"1-simple-action",children:"1. Simple Action"}),"\n",(0,c.jsx)(n.p,{children:"Running code on demand:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-groovy",children:'action("sayHello") {\n    justDo = {\n        println "Hello!"\n    }\n}\ndoAction("sayHello")\n'})}),"\n",(0,c.jsx)(n.h3,{id:"2-scheduled-action",children:"2. Scheduled Action"}),"\n",(0,c.jsx)(n.p,{children:"Running every 5 seconds:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-groovy",children:'action("tick") {\n    justDo = {\n        println "Tick: ${new Date()}"\n    }\n    schedule {\n        interval = 5_000\n        startImmediately = true\n    }\n}\n'})}),"\n",(0,c.jsx)(n.h3,{id:"3-dynamic-action-with-control",children:"3. Dynamic Action with Control"}),"\n",(0,c.jsx)(n.p,{children:"Controlled via subscription:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-groovy",children:'env.prefix = UUID.randomUUID().toString()\n\naction("logTime") {\n    justDo = {\n        println "Time: ${new Date()}"\n    }\n    schedule {\n        interval = 10_000\n        startImmediately = false\n    }\n}\n\nsubscribe("mqtt-mimic/${env.prefix}/on") { msg ->\n    activateAction("logTime")\n}\n\nsubscribe("mqtt-mimic/${env.prefix}/off") { msg ->\n    deactivateAction("logTime")\n}\n'})}),"\n",(0,c.jsx)(n.h3,{id:"4-interaction-with-publish",children:"4. Interaction with Publish"}),"\n",(0,c.jsxs)(n.p,{children:["Triggering a publish ",(0,c.jsx)(n.code,{children:"action"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-groovy",children:'action("triggerSend") {\n    justDo = {\n        doAction("sendHello")\n    }\n}\n\npublish("sendHello") {\n    topic = "greetings"\n    payload = "Message from action!"\n}\n\ndoAction("triggerSend")\n'})}),"\n",(0,c.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Required"}),": Specify ",(0,c.jsx)(n.code,{children:"justDo"}),", or the action won\u2019t do anything useful."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Execution"}),": Without ",(0,c.jsx)(n.code,{children:"schedule"})," or ",(0,c.jsx)(n.code,{children:"doAction"}),", the action won\u2019t run on its own."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Flexibility"}),": Use it for tasks beyond MQTT, like logging or calculations."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(a,{...e})}):a(e)}}}]);